<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Theme Debug - AutoImage</title>
    <link rel="stylesheet" href="css/optimized.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .debug-info {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            z-index: 1000;
        }
    </style>
</head>
<body class="bg-gray-800 text-gray-200 min-h-screen">
    <div class="debug-info" id="debug-info">
        <div>Theme: <span id="current-theme">Loading...</span></div>
        <div>CSS Variables:</div>
        <div id="css-vars">Loading...</div>
    </div>

    <div class="container mx-auto p-8">
        <h1 class="text-4xl font-bold mb-8 text-center">üé® Theme Debug Test</h1>

        <div class="max-w-4xl mx-auto">
            <!-- Theme Selector -->
            <div class="bg-gray-700 p-6 rounded-lg mb-8 border border-gray-600">
                <h2 class="text-2xl font-semibold mb-4">Theme Selector</h2>
                <select id="theme-debug-select" class="w-full bg-gray-600 text-white px-4 py-2 rounded-lg border border-gray-500">
                    <option value="default">üåô Default Dark</option>
                    <option value="professional">üíº Professional</option>
                    <option value="discord">üí¨ Discord</option>
                    <option value="apple">üçé Apple</option>
                    <option value="monokai">üé® Monokai</option>
                    <option value="highContrast">‚ö´ High Contrast</option>
                </select>
            </div>

            <!-- Test Components -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Card 1 -->
                <div class="bg-gray-700 p-6 rounded-lg border border-gray-600">
                    <h3 class="text-xl font-semibold mb-3">Sample Card 1</h3>
                    <p class="text-gray-300 mb-4">This card uses bg-gray-700 and border-gray-600</p>
                    <button class="bg-gray-600 hover:bg-gray-500 text-white px-4 py-2 rounded-lg transition-colors">Sample Button</button>
                </div>

                <!-- Card 2 -->
                <div class="bg-gray-600 p-6 rounded-lg border border-gray-500">
                    <h3 class="text-xl font-semibold mb-3">Sample Card 2</h3>
                    <p class="text-gray-400 mb-4">This card uses bg-gray-600 and border-gray-500</p>
                    <button class="bg-gray-500 hover:bg-gray-400 text-white px-4 py-2 rounded-lg transition-colors">Sample Button</button>
                </div>
            </div>

            <!-- Raw CSS Variables Display -->
            <div class="bg-gray-700 p-6 rounded-lg mt-6 border border-gray-600">
                <h3 class="text-xl font-semibold mb-3">Raw CSS Variables</h3>
                <div id="raw-css-vars" class="text-sm font-mono text-gray-300">
                    Loading...
                </div>
            </div>
        </div>
    </div>

    <!-- Theme Service -->
    <script src="js/themes/managers/ColorPaletteManager.js"></script>
    <script src="js/themes/composers/ThemeComposer.js"></script>
    <script src="js/themes/SimpleThemeService.js"></script>

    <script>
        // Wait for theme service to load
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                if (window.SimpleThemeService) {
                    initializeDebugTest();
                } else {
                    console.error('Theme service not loaded');
                    document.getElementById('debug-info').innerHTML = 'Theme service not loaded';
                }
            }, 100);
        });

        function initializeDebugTest() {
            const themeSelect = document.getElementById('theme-debug-select');
            const debugInfo = document.getElementById('debug-info');
            const currentTheme = document.getElementById('current-theme');
            const cssVars = document.getElementById('css-vars');
            const rawCssVars = document.getElementById('raw-css-vars');

            // Set initial theme
            const savedTheme = window.themeService.getCurrentTheme();
            themeSelect.value = savedTheme;
            updateDebugInfo();

            // Listen for theme changes
            themeSelect.addEventListener('change', (e) => {
                window.themeService.switchTheme(e.target.value);
                updateDebugInfo();
            });

            // Listen for theme service events
            document.addEventListener('themeChanged', () => {
                updateDebugInfo();
            });

            function updateDebugInfo() {
                const currentThemeName = window.themeService.getCurrentTheme();
                currentTheme.textContent = currentThemeName;

                // Get computed styles
                const computedStyle = getComputedStyle(document.documentElement);

                // Show key CSS variables
                const keyVars = [
                    '--color-gray-800',
                    '--color-gray-700',
                    '--color-gray-600',
                    '--color-gray-200',
                    '--color-gray-300',
                    '--color-gray-400'
                ];

                let varsHtml = '';
                keyVars.forEach(varName => {
                    const value = computedStyle.getPropertyValue(varName).trim();
                    varsHtml += `<div>${varName}: ${value || 'not set'}</div>`;
                });
                cssVars.innerHTML = varsHtml;

                // Show all CSS variables
                let allVarsHtml = '';
                for (let i = 0; i < computedStyle.length; i++) {
                    const prop = computedStyle[i];
                    if (prop.startsWith('--color-')) {
                        const value = computedStyle.getPropertyValue(prop).trim();
                        allVarsHtml += `<div>${prop}: ${value || 'not set'}</div>`;
                    }
                }
                rawCssVars.innerHTML = allVarsHtml || 'No CSS variables found';
            }

            // Initial update
            updateDebugInfo();
        }
    </script>
</body>
</html>
