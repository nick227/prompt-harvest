<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AutoImage - AI Image Generator</title>
    <link rel="stylesheet" href="css/optimized.css" />
    <link rel="stylesheet" href="css/mobile.css" />
    <link rel="stylesheet" href="css/credits-modal.css" />
    <!-- AI Chat Widget CSS will be loaded lazily -->
    <link rel="icon" href="/images/favicon.png" type="image/png" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Tailwind Configuration -->
    <script src="js/config/tailwind-config.js"></script>
    <!-- Input Helper Functions -->
    <script src="js/utils/input-helpers.js"></script>
    <!-- Tag Utilities -->
    <script src="js/utils/tag-utils.js"></script>

</head>

<body class="bg-gray-800 text-gray-200 w-full min-h-screen">

    <!-- Unified Drawer Components (Desktop & Mobile) -->
    <!-- These will be dynamically created by the UnifiedDrawerComponent -->

    <!-- Drawer Toggle Button (when closed) -->
    <button id="drawer-toggle-closed"
        class="fixed left-4 top-4 bg-gray-800 text-white p-2 rounded-lg hover:bg-gray-700 transition-colors z-50 shadow-lg hidden max-sm:left-2 max-sm:top-2 max-sm:p-1.5">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 5l7 7-7 7"></path>
        </svg>
    </button>

    <!-- Mobile Hamburger Menu Button (mobile only) -->
    <button id="mobile-hamburger"
        class="fixed left-4 top-4 bg-gray-800 text-white p-3 rounded-lg hover:bg-gray-700 transition-colors z-50 shadow-lg mobile-only">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
    </button>

    <main class="flex-col gap-4 h-full max-w-[1080px] mx-auto main-container magic-container">
        <!-- Main Controls Bar -->
        <div class="w-full mb-4 flex flex-col gap-4 main-controls-container">
            <!-- Featured Controls Row -->
            <div class="flex items-end justify-between">
                <div class="flex items-center gap-4">
                    <!-- Featured Settings -->
                    <div class="flex items-center gap-3">
                        <label class="flex items-center gap-1 cursor-pointer label secondary enhance-label">
                            <input type="checkbox" name="auto-enhance" />
                            <span>Enhance</span>
                        </label>
                        <label class="flex items-center gap-1 cursor-pointer label accent auto-label">
                            <input type="checkbox" name="auto-generate" />
                            <span>Auto</span>
                        </label>
                        <input type="number" name="maxNum" id="maxNum"
                            class="w-24 bg-white text-gray-800 px-2 py-1 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="max" min="1" max="10" value="3" oninput="validateMaxNum(this)"
                            onkeypress="preventInvalidChars(event)" onpaste="handleMaxNumPaste(event)" />
                    </div>
                </div>

                <div class="flex items-end">
                    <!-- Magic Prompt -->
                    <button
                        class="btn-magic bg-gray-700 text-white px-3 py-1 rounded text-sm hover:bg-gray-600 transition-colors whitespace-nowrap"><i
                            class="fas fa-wand-magic-sparkles"></i></button>
                </div>

            </div>
        </div>

        <!-- Enhanced Notification Display -->
        <div id="notification-container" class="fixed top-4 right-4 z-50 space-y-2"></div>

        <!-- Prompt Textarea -->
        <textarea id="prompt-textarea"
            class="w-full bg-white text-gray-800 px-3 py-2 rounded resize-none focus:outline-none focus:ring-2 focus:ring-blue-500"
            style="max-height: 90vh; overflow-y: auto; resize: vertical; min-height: 80px;"
            rows="3" placeholder="Enter your prompt here..."></textarea>

        <!-- Generate Button -->
        <div class="w-full mt-4">
            <button type="button"
                class="btn-generate w-full bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-semibold focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-800">START</button>
        </div>

        <!-- Matches -->
        <ul id="matches" class="matches flex flex-wrap gap-2 max-h-32 overflow-y-auto"></ul>

        <!-- Tags in use -->
        <div id="tags-in-use" class="tags-in-use flex flex-wrap gap-2 max-h-32 overflow-y-auto hidden"></div>

        <!-- Image Display -->
        <div class="w-full flex flex-col min-w-0 mt-4 section-images">
            <div class="flex flex-col h-full">
                <!-- Controls Bar -->
                <div class="flex items-center justify-between mb-4 flex-wrap gap-4 w-full">

                    <div class="flex items-center gap-2 flex-wrap">
                        <!-- View Switch -->
                        <label class="bg-gray-700 text-white px-3 py-1 rounded hover:bg-gray-600 transition-colors hide-on-mobile">
                            <input type="radio" name="view" value="full"> Full</label>
                            <label class="bg-gray-700 text-white px-3 py-1 rounded hover:bg-gray-600 transition-colors">
                                <input type="radio" name="view" value="list"> List</label>
                        <label class="bg-gray-700 text-yellow-400 px-3 py-1 rounded hover:bg-gray-600 transition-colors"
                            data-owner="1">
                            <input type="radio" name="view" value="compact" checked> Compact</label>
                        <!-- Owner Filter Dropdown -->
                        <select name="owner"
                            class="bg-gray-700 text-white px-3 py-1 rounded hover:bg-gray-600 transition-colors border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="public">Public &nbsp;ðŸŸ¢</option>
                            <option value="private" selected>Private ðŸ”’</option>
                        </select>
                    </div>
                    <!-- Search Container -->
                    <div class="search-container">
                        <input type="text" name="search" id="search" placeholder="Search"
                            class="bg-gray-700 text-white px-3 py-1 rounded hover:bg-gray-600 transition-colors border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>

                </div>
            </div>

                <!-- Image Grid -->
                <div id="image-container-main" class="prompt-output flex flex-wrap gap-2 pb-16 h-full overflow-y-auto">
                </div>
            </div>
    </main>

    <!-- External Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="js/config/tailwind-config.js"></script>
    <script src="js/utils/input-helpers.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>

    <!-- Core Components (Required for functionality) -->
    <script src="js/components/transaction-stats-component.js"></script>
    <!-- Shared Credit Purchase Modal -->
    <script src="js/shared/CreditPurchaseModal.js"></script>
    <script src="js/components/credit-balance-widget.js"></script>
    <script src="js/components/header-component.js"></script>
    <script src="js/components/simple-drawer.js"></script>
    <script src="js/components/theme-manager.js"></script>
    <script src="js/components/global-credits-modal.js"></script>
    <!-- AI Chat Widget temporarily removed -->
    <script src="js/components/ai-image-generator-widget.js"></script>
    <script src="js/components/rating-buttons.js"></script>
    <script src="js/components/multiselect-dropdown.js"></script>
    <script src="js/components/profile-component.js"></script>

    <!-- Core Services -->
    <script src="js/core/constants.js"></script>
    <script src="js/core/utils.js"></script>
    <script src="js/core/auth-utils.js"></script>
    <script src="js/core/unified-auth-utils.js"></script>
    <script src="js/core/api-service.js"></script>
    <script src="js/core/notification-service.js"></script>
    <script src="js/core/user-system.js"></script>
    <script src="js/core/error-handler.js"></script>
    <script src="js/core/image-factory.js"></script>

    <!-- Services -->
    <script src="js/services/stats-service.js"></script>
    <script src="js/services/public-status-service.js"></script>
    <script src="js/services/prompt-organizer-service.js"></script>
    <script src="js/services/UnifiedCreditService.js"></script>
    <script src="js/services/unified-stats-service.js"></script>
    <script src="js/services/unified-event-service.js"></script>
    <script src="js/services/messaging-service.js"></script>
    <script src="js/services/ai-image-generator-service.js"></script>
    <script src="js/services/CreditsModalService.js"></script>

    <!-- Image System -->
    <script src="js/components/image/image-manager.js"></script>
    <script src="js/components/image/unified-info-box.js"></script>
    <script src="js/components/image/unified-navigation.js"></script>
    <script src="js/components/image/image-component.js"></script>
    <script src="js/components/image/image-data.js"></script>
    <script src="js/components/image/image-elements.js"></script>
    <script src="js/components/image/image-events.js"></script>
    <script src="js/components/image/image-placeholder-handler.js"></script>
    <script src="js/components/image/image-ui-manager.js"></script>
    <script src="js/components/image/fullscreen-components.js"></script>
    <script src="js/components/image/ui-config.js"></script>
    <script src="js/components/image/navigation-controls.js"></script>
    <script src="js/components/mobile-table.js"></script>

    <!-- Debug Configuration (load FIRST for all modules) -->
    <script src="js/config/debug-config.js"></script>

    <!-- Prompt Helpers System -->
    <script src="js/config/prompt-helpers.js"></script>
    <script src="js/components/prompt-helpers-form.js"></script>

    <!-- Centralized View System (load before feed-view-manager) -->
    <script src="js/modules/views/ViewRegistry.js"></script>
    <script src="js/modules/views/ViewManager.js"></script>
    <script src="js/modules/views/ViewRenderer.js"></script>

    <!-- Feed System -->
    <script src="js/modules/feed/feed-constants.js"></script>
    <script src="js/modules/feed/feed-dom-operations.js"></script>
    <script src="js/modules/feed/feed-image-handler.js"></script>
    <script src="js/modules/feed/feed-download-manager.js"></script>
    <script src="js/modules/feed/feed-cache-manager.js"></script>
    <script src="js/modules/feed/feed-api-manager.js"></script>
    <!-- Feed UI Dependencies (load before feed-ui-manager) -->
    <script src="js/modules/feed/feed-ui-helpers.js"></script>
    <script src="js/modules/feed/feed-ui-event-factory.js"></script>
    <script src="js/modules/feed/feed-transition-manager.js"></script>
    <script src="js/modules/feed/feed-tag-ui.js"></script>
    <script src="js/modules/feed/feed-ui-static-helpers.js"></script>
    <script src="js/modules/feed/feed-ui-lifecycle.js"></script>
    <script src="js/modules/feed/feed-ui-manager.js"></script>
    <script src="js/modules/feed/feed-filter-manager.js"></script>
    <script src="js/modules/feed/feed-view-manager.js"></script>
    <script src="js/modules/feed/feed-manager-core.js"></script>
    <script src="js/modules/feed/fill-to-bottom-manager.js"></script>
    <script src="js/modules/feed/hybrid-tab-service.js"></script>
    <script src="js/modules/feed/image-count-manager.js"></script>

    <!-- Themes -->
    <script src="js/themes/managers/ColorPaletteManager.js"></script>
    <script src="js/themes/composers/ThemeComposer.js"></script>
    <script src="js/themes/ThemeCSSGenerator.js"></script>
    <script src="js/themes/SimpleThemeService.js"></script>
    <script src="js/themes/ThemeValidator.js"></script>
    <script src="js/themes/ThemePreview.js"></script>
    <script src="js/themes/ThemeReadabilityTester.js"></script>

    <!-- Textarea Modules -->
    <script src="js/modules/textarea/text-utils.js"></script>
    <script src="js/modules/textarea/textarea-utils.js"></script>
    <script src="js/modules/textarea/match-processor.js"></script>
    <script src="js/modules/textarea/auto-resize-manager.js"></script>
    <script src="js/modules/textarea/match-manager.js"></script>
    <script src="js/modules/textarea/event-manager.js"></script>
    <script src="js/modules/textarea/search-replace.js"></script>
    <script src="js/modules/textarea/textarea-manager.js"></script>
    <script src="js/modules/textarea.js"></script>

    <!-- Wrapper Dataset Utilities - Must load before feed/image handlers -->
    <script src="js/utils/wrapper-dataset-utils.js"></script>
    <script src="js/modules/guidance/guidance-manager.js"></script>
    <script src="js/modules/rating/rating-manager.js"></script>
    <script src="js/modules/stats/stats-manager.js"></script>
    <script src="js/modules/image-generation-api.js"></script>
    <script src="js/modules/image/ImageElementFactory.js"></script>
    <script src="js/modules/image/LoadingPlaceholderFactory.js"></script>
    <script src="js/modules/image/ImageViewManager.js"></script>
    <script src="js/modules/image/ImageDataManager.js"></script>

    <!-- Load modular image-view dependencies -->
    <script src="js/modules/shared/image-view/image-view-auth.js"></script>
    <script src="js/modules/shared/image-view/image-view-data.js"></script>
    <script src="js/modules/shared/image-view/image-view-tags.js"></script>
    <script src="js/modules/shared/image-view/image-view-prompts.js"></script>
    <script src="js/modules/shared/image-view/image-view-public-toggle.js"></script>
    <script src="js/modules/shared/image-view/image-view-dom-updates.js"></script>
    <script src="js/modules/shared/image-view/image-view-integration.js"></script>
    <!-- Main utils file that uses the modules -->
    <script src="js/modules/shared/image-view-utils.js"></script>
    <script src="js/modules/image-dom-manager.js"></script>
    <script src="js/modules/image-ui-state.js"></script>
    <script src="js/modules/images-manager.js"></script>
    <!-- Search helper modules (loaded before main search.js) -->
    <script src="js/modules/search/search-api-utils.js"></script>
    <script src="js/modules/search/search-id-generator.js"></script>
    <script src="js/modules/search/search-cache-manager.js"></script>
    <script src="js/modules/search/search-retry-strategy.js"></script>
    <script src="js/modules/search/search-event-emitter.js"></script>
    <script src="js/modules/search/search-state-manager.js"></script>
    <script src="js/modules/search/search-execution-manager.js"></script>
    <script src="js/modules/search/search-pagination-manager.js"></script>
    <script src="js/modules/search/search-filter-manager.js"></script>
    <script src="js/modules/search/search-ui-manager.js"></script>
    <script src="js/modules/search/search-filter-helpers.js"></script>
    <script src="js/modules/search/search-ui-components.js"></script>
    <!-- Search coordinators and handlers (new modular architecture) -->
    <script src="js/modules/search/SearchCoordinator.js"></script>
    <script src="js/modules/search/SearchFilterCoordinator.js"></script>
    <script src="js/modules/search/SearchDisplayManager.js"></script>
    <script src="js/modules/search/SearchResultProcessor.js"></script>
    <script src="js/modules/search/SearchFeedIntegration.js"></script>
    <script src="js/modules/search/SearchResultDisplay.js"></script>
    <script src="js/modules/search/SearchEventHandler.js"></script>
    <script src="js/modules/search/SearchPaginationHandler.js"></script>
    <!-- Main search manager -->
    <script src="js/modules/search.js"></script>
    <script src="js/utils/search-router.js"></script>
    <script src="js/modules/providers/provider-manager.js"></script>
    <script src="js/utils/tag-router.js"></script>

    <!-- Main App -->
    <script src="js/app.js"></script>


</body>

</html>
