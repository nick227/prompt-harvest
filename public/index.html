<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AutoImage - AI Image Generator</title>
    <link rel="stylesheet" href="css/optimized.css" />
    <link rel="stylesheet" href="css/mobile.css" />
    <link rel="stylesheet" href="css/credits-modal.css" />
    <link rel="icon" href="/images/favicon.png" type="image/png" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Tailwind Configuration -->
    <script src="js/config/tailwind-config.js"></script>
    <!-- Input Helper Functions -->
    <script src="js/utils/input-helpers.js"></script>

</head>

<body class="bg-gray-800 text-gray-200 w-full min-h-screen">

    <!-- Unified Drawer Components (Desktop & Mobile) -->
    <!-- These will be dynamically created by the UnifiedDrawerComponent -->

    <!-- Drawer Toggle Button (when closed) -->
    <button id="drawer-toggle-closed"
        class="fixed left-4 top-4 bg-gray-800 text-white p-2 rounded-lg hover:bg-gray-700 transition-colors z-50 shadow-lg hidden max-sm:left-2 max-sm:top-2 max-sm:p-1.5">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 5l7 7-7 7"></path>
        </svg>
    </button>

    <!-- Mobile Hamburger Menu Button (mobile only) -->
    <button id="mobile-hamburger"
        class="fixed left-4 top-4 bg-gray-800 text-white p-3 rounded-lg hover:bg-gray-700 transition-colors z-50 shadow-lg mobile-only">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
    </button>

    <main class="flex-col gap-4 h-full max-w-[1080px] mx-auto main-container">
        <!-- Main Controls Bar -->
        <div class="w-full mb-4 flex flex-col gap-4 main-controls-container">
            <!-- Featured Controls Row -->
            <div class="flex items-end justify-between">
                <div class="flex items-center gap-4">
                    <!-- Featured Settings -->
                    <div class="flex items-center gap-3">
                        <label class="flex items-center gap-1 cursor-pointer label secondary enhance-label">
                            <input type="checkbox" name="auto-enhance" />
                            <span>Enhance</span>
                        </label>
                        <label class="flex items-center gap-1 cursor-pointer label accent auto-label">
                            <input type="checkbox" name="auto-generate" />
                            <span>Auto</span>
                        </label>
                        <input type="number" name="maxNum" id="maxNum"
                            class="w-24 bg-white text-gray-800 px-2 py-1 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="max" min="1" max="10" value="3"
                            oninput="validateMaxNum(this)"
                            onkeypress="preventInvalidChars(event)"
                            onpaste="handleMaxNumPaste(event)" />
                    </div>
                </div>

                <!-- Search / Replace -->
                <div class="flex items-center gap-2 search-replace">
                    <input type="text" placeholder="search" name="search_term" id="search_term"
                        class="w-20 bg-white text-gray-800 px-2 py-1 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" />
                    <input type="text" placeholder="replace" name="replace_term" id="replace_term"
                        class="w-20 bg-white text-gray-800 px-2 py-1 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" />
                    <button
                        class="btn-replace bg-gray-700 text-white px-3 py-1 rounded text-sm hover:bg-gray-600 transition-colors whitespace-nowrap">Replace</button>
                    <button
                        class="btn-record bg-gray-700 text-white px-3 py-1 rounded text-sm hover:bg-gray-600 transition-colors whitespace-nowrap"><i
                            class="fas fa-microphone"></i></button>
                </div>

            </div>
        </div>

        <!-- Enhanced Notification Display -->
        <div id="notification-container" class="fixed top-4 right-4 z-50 space-y-2"></div>

        <!-- Prompt Textarea -->
        <textarea id="prompt-textarea"
            class="w-full bg-white text-gray-800 px-3 py-2 rounded resize-none focus:outline-none focus:ring-2 focus:ring-blue-500"
            rows="6" placeholder="Enter your prompt here..."></textarea>

        <!-- Generate Button -->
        <div class="w-full mt-4">
            <button type="button"
                class="btn-generate w-full bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-semibold focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-800">START</button>
        </div>

        <!-- Matches -->
        <ul id="matches" class="matches flex flex-wrap gap-2 max-h-32 overflow-y-auto"></ul>
        </div>

        <!-- Tags in use -->
        <div id="tags-in-use" class="tags-in-use flex flex-wrap gap-2 max-h-32 overflow-y-auto hidden"></div>
        </div>

        <!-- Image Display -->
        <div class="w-full flex flex-col min-w-0 mt-4">
            <div class="flex flex-col h-full">
                <!-- Controls Bar -->
                <div class="flex items-center justify-between mb-4 flex-wrap gap-4 flex-wrap">

                    <div class="view-switch flex items-center gap-2 flex-wrap w-full">
                        <!-- View Switch -->
                        <label class="bg-gray-700 text-white px-3 py-1 rounded hover:bg-gray-600 transition-colors">
                            <input type="radio" name="view" value="list"> List</label>
                        <label class="bg-gray-700 text-yellow-400 px-3 py-1 rounded hover:bg-gray-600 transition-colors"
                            data-owner="1">
                            <input type="radio" name="view" value="compact" checked> Compact</label>
                        <!-- Owner Filter Dropdown -->
                        <select name="owner" class="bg-gray-700 text-white px-3 py-1 rounded hover:bg-gray-600 transition-colors border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="site">Public</option>
                            <option value="user" selected>Private</option>
                        </select>
                    </div>
                </div>

                <!-- Image Grid -->
                <div id="image-container-main" class="prompt-output flex flex-wrap gap-2 pb-16 h-full overflow-y-auto"></div>
            </div>
        </div>
    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>

    <!-- Header Component -->
    <script src="js/components/header-component.js"></script>

    <!-- Theme Service (simplified palette system) -->
    <script src="js/themes/managers/ColorPaletteManager.js"></script>
    <script src="js/themes/composers/ThemeComposer.js"></script>
    <script src="js/themes/ThemeCSSGenerator.js"></script>
    <script src="js/themes/ThemeServiceTester.js"></script>
    <script src="js/themes/SimpleThemeService.js"></script>
    <script src="js/themes/ThemeValidator.js"></script>
    <script src="js/themes/ThemePreview.js"></script>
    <script src="js/themes/ThemeReadabilityTester.js"></script>

    <!-- Unified Drawer Component -->
    <script src="js/components/unified-drawer-component.js"></script>

    <!-- Theme Manager (must load after unified drawer) -->
    <script src="js/components/theme-manager.js"></script>

    <!-- Controls Drawer Component -->
    <script src="js/components/controls-drawer.js"></script>

    <!-- Mobile Controls Manager -->
    <script src="js/components/mobile-controls-manager.js"></script>

    <!-- Services (must load before components that use them) -->
    <script src="js/services/stats-service.js"></script>

    <!-- Transaction Stats Component -->
    <script src="js/components/transaction-stats-component.js"></script>

    <!-- Core modules -->
    <script src="js/core/constants.js"></script>
    <script src="js/core/utils.js"></script>

    <!-- Authentication utilities (must load early) -->
    <script src="js/core/auth-utils.js"></script>

    <!-- Unified Authentication Utilities (centralized auth interface) -->
    <script src="js/core/unified-auth-utils.js"></script>

    <!-- Load api-service first -->
    <script src="js/core/api-service.js"></script>

    <!-- Notification Service -->
    <script src="js/core/notification-service.js"></script>

    <!-- Prompt History Service -->
    <script src="js/core/prompt-history-service.js"></script>



    <!-- Unified User System (replaces all user management) -->
    <script src="js/core/user-system.js"></script>

    <!-- Services -->
    <script src="js/services/speech-to-text-service.js"></script>

    <!-- Image Component (Refactored Architecture) -->
    <script src="js/components/image/ui-config.js"></script>
    <!-- Image Event Dependencies (must load before image-events.js) -->
    <script src="js/modules/ImageDetection.js"></script>
    <script src="js/modules/legacy-auth-utils.js"></script>
    <script src="js/modules/NotificationManager.js"></script>
    <script src="js/modules/TouchEventHandler.js"></script>

    <script src="js/components/image/image-placeholder-handler.js"></script>
    <script src="js/components/image/image-elements.js"></script>
    <script src="js/components/image/navigation-controls.js"></script>
    <script src="js/components/image/fullscreen-components.js"></script>
    <script src="js/components/image/image-ui-manager.js"></script>
    <script src="js/components/image/image-events.js"></script>
    <script src="js/components/image/image-data.js"></script>
    <script src="js/components/image/image-manager.js"></script>
    <script src="js/components/image/image-component.js"></script>

    <!-- Unified Info Box Component -->
    <script src="js/components/image/unified-info-box.js"></script>

    <!-- Simplified Navigation System -->
    <script src="js/components/image/simplified-navigation.js"></script>
    <script src="js/components/image/navigation-integration.js"></script>

    <!-- Component modules -->
    <script src="js/components/multiselect-dropdown.js"></script>

    <!-- Feature modules -->
    <!-- TextArea Module (Refactored) -->
    <script src="js/modules/textarea/text-utils.js"></script>
    <script src="js/modules/textarea/match-processor.js"></script>
    <script src="js/modules/textarea/search-replace.js"></script>
    <script src="js/modules/textarea/textarea-manager.js"></script>
    <script src="js/modules/textarea.js"></script>
    <script src="js/modules/search.js"></script>
    <!-- Refactored Feed System -->
    <script src="js/utils/tag-router.js"></script>
    <script src="js/utils/overlay-manager.js"></script>
    <script src="js/modules/feed/feed-constants.js"></script>
    <script src="js/modules/feed/feed-cache-manager.js"></script>
    <script src="js/modules/feed/hybrid-tab-service.js"></script>
    <script src="js/modules/feed/image-count-manager.js"></script>
    <script src="js/modules/feed/feed-filter-manager.js"></script>
    <script src="js/modules/feed/feed-dom-manager.js"></script>
    <script src="js/modules/feed/feed-api-manager.js"></script>
    <script src="js/modules/feed/feed-ui-manager.js"></script>
    <script src="js/modules/feed/feed-view-manager.js"></script>
    <script src="js/modules/feed/fill-to-bottom-manager.js"></script>
    <script src="js/modules/feed/feed-manager-refactored.js"></script>
    <script src="js/modules/guidance/guidance-manager.js"></script>

    <!-- Rating Buttons Component (must load before rating-manager) -->
    <script src="js/components/rating-buttons.js"></script>

    <script src="js/modules/rating/rating-manager.js"></script>
    <script src="js/modules/stats/stats-manager.js"></script>
    <script src="js/modules/providers/provider-manager.js"></script>

    <!-- Core modules -->
    <script src="js/tools.js"></script>

    <!-- Shared Utilities (must be loaded first) -->
    <script src="js/modules/shared/image-dom-utils.js"></script>
    <script src="js/modules/shared/image-view-utils.js"></script>

    <!-- Image DOM Components (must load before image-dom-manager) -->
    <script src="js/modules/image/ImageDOMContracts.js"></script>
    <script src="js/modules/image/ImageElementFactory.js"></script>
    <script src="js/modules/image/LoadingPlaceholderFactory.js"></script>
    <script src="js/modules/image/ImageViewManager.js"></script>
    <script src="js/modules/image/ImageDataManager.js"></script>

    <!-- Modular Images System -->
    <script src="js/modules/image-generation-api.js"></script>
    <script src="js/services/UnifiedCreditService.js"></script>
    <script src="js/services/CreditsModalService.js"></script>
    <script src="js/modules/image-dom-manager.js"></script>
    <script src="js/modules/image-ui-state.js"></script>
    <script src="js/modules/images-manager.js"></script>

    <!-- Generation Component (Separated Architecture) -->
    <script src="js/components/generation/generation-ui.js"></script>
    <script src="js/components/generation/generation-events.js"></script>
    <script src="js/components/generation/generation-data.js"></script>
    <script src="js/components/generation/generation-manager.js"></script>
    <script src="js/components/generation/generation-component.js"></script>

    <!-- Test Scripts removed -->

    <!-- Main application loader -->
    <script src="js/app.js"></script>


</body>

</html>
